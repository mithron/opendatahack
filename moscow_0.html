<html>
<head>
	<title>Московские школы</title>
	<meta charset="utf-8">
	
	<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" />
	<script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
	
	<script type="text/javascript" src="http://code.jquery.com/jquery-1.9.1.min.js"></script>	

    <link rel="stylesheet" href="leaflet-dvf/dist/css/dvf.css" type="text/css" />
    <script type="text/javascript" src="leaflet-dvf/dist/leaflet-dvf.min.js"></script>
    <script type="text/javascript" src="leaflet-dvf/src/leaflet.dvf.experimental.js"></script>

    <link rel="stylesheet" href="Leaflet.StyledLayerControl/css/styledLayerControl.css" />
    <script src="Leaflet.StyledLayerControl//src/styledLayerControl.js"></script>
	
	<script src="leaflet-sidebar/src/L.Control.Sidebar.js"></script>
	<link rel="stylesheet" href="leaflet-sidebar/src/L.Control.Sidebar.css" />
	
	<link rel="stylesheet" href="Leaflet.loading/src/Control.Loading.css" />
    <script src="Leaflet.loading/src/Control.Loading.js"></script>
	
	<script src="spin.min.js"></script>
	
</head>
<body>
	<div id="sidebar">
		<h1>Здравствуйте!</h1>
		<p>Перед вами - справочник по расходам московских школ.</p>
	</div>
	<div id="map"> </div>
	
	<script defer="defer" src="schools_data.js"></script>
    <script defer="defer" src="contract_data2.js"></script>
	<script defer="defer" src="main.js"></script>
	
	<script>
	var map;

	var resize = function () {
		var $map = $('#map');

		$map.height($(window).height() - $('div.navbar').outerHeight());

		if (map) {
			map.invalidateSize();
		}
	};

	$(window).on('resize', function () {
		resize();
	});

	resize();

	map = L.map('map').setView([55.75, 37.63], 10);
	L.tileLayer('https://{s}.tiles.mapbox.com/v3/{id}/{z}/{x}/{y}.png',
			{maxZoom: 18, 
			attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' + 
			'<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
			'Imagery © <a href="http://mapbox.com">Mapbox</a>', id: 'examples.map-i875mjb7'
			}).addTo(map);

        // Add a layer control
    var base = [];
    var over = [];
    var layerControl = L.Control.styledLayerControl(base, over, { collapsed:false, container_width: "200px",
            container_maxHeight: "550px",  group_maxHeight: "550px", exclusive: false}).addTo(map);
		 
	var loadingControl = L.Control.loading({
            separate: true, spinjs:true, 
			spin: { lines: 15, length: 5, width: 5, radius: 4, corners: 1, rotate: 13,
			direction: 1, color: '#000', speed: 1, trail: 60, shadow: false, hwaccel: false, 
			zIndex: 2e9, top: '50%', left: '50%' 
			}
                });
    map.addControl(loadingControl);
	map.fire("dataloading");
	
	var sidebar = L.control.sidebar('sidebar', {
            closeButton: true,
            position: 'left'
       });
    map.addControl(sidebar);
    setTimeout(function () {
            sidebar.show();
        }, 500);	
	</script>
</body></html>
